<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mortgagee Clause Directory</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .copy-btn:active { transform: scale(0.95); }
    </style>
</head>
<body class="bg-gray-50 text-gray-900 font-sans">

    <div class="max-w-6xl mx-auto px-4 py-8">
        <header class="mb-8 text-center">
            <h1 class="text-3xl font-bold text-blue-900">Mortgagee Clause Directory</h1>
            <p class="text-gray-600 mt-2">Search for lender ISAOA/ATIMA and mailing addresses.</p>
        </header>

        <div class="mb-6">
            <input type="text" id="searchInput" placeholder="Search by lender name, city, or state (e.g. 'Chase' or 'Maitland')..." 
                class="w-full p-4 rounded-lg border border-gray-300 shadow-sm focus:ring-2 focus:ring-blue-500 focus:outline-none text-lg">
        </div>

        <div class="overflow-x-auto bg-white rounded-lg shadow">
            <table class="min-w-full divide-y divide-gray-200" id="mortgageeTable">
                <thead class="bg-gray-100">
                    <tr>
                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase">Lender / ISAOA</th>
                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase">Mailing Address</th>
                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase">Contact</th>
                        <th class="px-6 py-4 text-center text-xs font-semibold text-gray-600 uppercase">Action</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-200" id="tableBody">
                    </tbody>
            </table>
        </div>
    </div>

    <script>
        const tableBody = document.getElementById('tableBody');
        const searchInput = document.getElementById('searchInput');
        let mortgageeData = [];

        // Load your JSON file
        fetch('appsmith_data.mortgage_list.json')
            .then(response => response.json())
            .then(data => {
                mortgageeData = data;
                displayData(mortgageeData);
            })
            .catch(err => console.error('Error loading JSON:', err));

        function displayData(data) {
            tableBody.innerHTML = '';
            data.forEach((item, index) => {
                const fullAddress = `${item.Address}, ${item.City}, ${item.State} ${item.ZIP}`;
                const row = `
                    <tr class="hover:bg-blue-50 transition-colors">
                        <td class="px-6 py-4">
                            <div class="font-bold text-blue-800">${item.Name}</div>
                            <div class="text-sm text-gray-500 italic">${item.Name2 || ''}</div>
                        </td>
                        <td class="px-6 py-4 text-sm">
                            ${fullAddress}
                        </td>
                        <td class="px-6 py-4 text-sm text-gray-600">
                            ${item.FAX ? 'Fax: ' + item.FAX : ''}<br>
                            ${item.Telephone ? 'Ph: ' + item.Telephone : ''}
                        </td>
                        <td class="px-6 py-4 text-center">
                            <button onclick="copyToClipboard('${item.Name}\\n${item.Name2 || ''}\\n${fullAddress}')" 
                                class="copy-btn bg-blue-600 text-white px-3 py-1 rounded text-xs hover:bg-blue-700 transition">
                                Copy Clause
                            </button>
                        </td>
                    </tr>
                `;
                tableBody.insertAdjacentHTML('beforeend', row);
            });
        }

        // Search logic
        searchInput.addEventListener('input', (e) => {
            const term = e.target.value.toLowerCase();
            const filtered = mortgageeData.filter(item => 
                item.Name.toLowerCase().includes(term) || 
                item.City.toLowerCase().includes(term) ||
                item.State.toLowerCase().includes(term)
            );
            displayData(filtered);
        });

        // Copy functionality
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('Mortgagee clause copied to clipboard!');
            });
        }
    </script>
</body>
</html>
